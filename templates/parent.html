<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Hull White model</title>

    <meta name="description" content="Etude de la convergence de BOPM to BSM">
    <meta name="author" content="LayoutIt!">

    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">

</head>
<style>
    table, tr td {
        border: 1px solid red
    }

    tbody {
        display: block;
        max-height: 90%;
        overflow-y: scroll;
    }

    thead, tbody tr {
        display: table;
        width: 100%;
        table-layout: fixed;
    }

    thead {
        width: 100%;
    }

    table {
        width: 100%;
    }

</style>
<body>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <nav class="navbar navbar-default navbar-inverse" role="navigation">
                <div class="navbar-header">

                    <button type="button" class="navbar-toggle" data-toggle="collapse"
                            data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span
                            class="icon-bar"></span><span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">Hull White</a>
                </div>

                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">


                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="/document">Resources</a>
                        </li>
                        <li>
                            <a href="/about">About</a>
                        </li>
                    </ul>
                </div>

            </nav>

            <br><br><br>

            {% block content %}

                <div class="page-header" style="margin: 1%">
                    <h1>
                        Hull White
                        <small> Numerical implementation of Hull White model using python</small>
                    </h1>
                    <p>
                        The purpose of this website is to implement the interest rate model Hull White
                </div>
                <br><br><br>

                <form role="form" id="computeForm" method="get" action="/" >
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-2">

                            <div class="form-group">
                                <label for="maturity">
                                    Maturity
                                </label>
                                <input type="number" step="1" min="1" max="50" class="form-control"
                                       id="maturity" name="maturity"/>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label for="volatility">
                                    Volatility (%)
                                </label>
                                <input type="number" step="0.1" min="0.01" max="100" class="form-control" name="volatility"/>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group">
                                <label for="alpha">
                                    Alpha
                                </label>
                                <input type="number" step="0.1" min="0.01" max="100" class="form-control"
                                       id="alpha"name="alpha"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label for="stp">
                                    Step
                                </label>
                                <input type="number" step="1" min="1" max="10" class="form-control"
                                       id="step" name="step"/>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label for="exampleInputEmail1">

                                </label>
                                <input type="submit" class="btn btn-block  btn-primary" id="exampleInputEmail1"/>
                            </div>
                        </div>
                    </div>
                </div>
                </form>
                <div class="row" style="margin: 1%">

                    <div class="col-md-12 border_1" style="height: 650px;padding: 5px">

                        <div id="chart_div" class="row" style="height: 97%;padding: 2%"></div>
                    </div>

                </div>
                </div>
                </div>
            {% endblock %}
</div>
</div>


<script src="/static/js/jquery.min.js"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/scripts.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

    google.charts.load('current', {packages: ['corechart']});
    google.charts.setOnLoadCallback(drawTrendlines);

    function drawTrendlines() {
        var data = new google.visualization.DataTable();
        data.addColumn('number', 'Maturity');
        data.addColumn('number', 'R(t)');
        data_hw =
        {{hw_json|safe}}
        var options = {
            pointsVisible: true,
            interpolateNulls: true,
            title: "Hull White interest rate",
            width: '100%',
            height: '100%',
            hAxis: {
                title: 'Maturity'
            },
            vAxis: {
                title: 'Rate'
            },
            colors: ['#AB0D06', '#007329'],

        };
        var step = data_hw.step;
        var x = data_hw.x;
        for (var i = 0; i < step; i++) {
        var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
            var nodes = Math.min(3 + 2 * (i - 2), 1 + 2 * data_hw.jmax);
            if (3 + 2 * (i - 1) <= 1 + 2 * data_hw.jmax) {
                for (var j = 0; j < nodes; j++) {
                    data.addRows([[i, x[i][j]], [i + 1, x[i + 1][j]]]);
                    data.addRows([[i, x[i][j]], [i + 1, x[i + 1][j + 1]]]);
                    data.addRows([[i, x[i][j]], [i + 1, x[i + 1][j + 2]]]);
                    chart.draw(data, options);
                }

            } else {

                data.addRows([[i, x[i][1]], [i + 1, x[i + 1][1]]]);
                chart.draw(data, options);

                data.addRows([[i, x[i][1]], [i + 1, x[i + 1][2]]]);
                chart.draw(data, options);

                data.addRows([[i, x[i][1]], [i + 1, x[i + 1][3]]]);
                chart.draw(data, options)

                for (var j = 1; j < nodes; j++) {

                    data.addRows([[i, x[i][j]], [i + 1, x[i + 1][j - 1]]]);
                    chart.draw(data, options);

                    data.addRows([[i, x[i][j]], [i + 1, x[i + 1][j]]]);
                    chart.draw(data, options);

                    data.addRows([[i, x[i][j]], [i + 1, x[i + 1][j + 1]]]);
                    chart.draw(data, options);
                }

            }
        }
    }
</script>
</body>
</html>